{
  "_comment": "EVMS (c) Shane D. Shook, PhD, 2025 All Rights Reserved",
  "_description": "Default configuration for EVMS platform",
  
  "server": {
    "port": 3000,
    "host": "0.0.0.0",
    "cors": {
      "origin": false,
      "credentials": true
    }
  },
  
  "database": {
    "neo4j": {
      "uri": "bolt://localhost:7687",
      "username": "neo4j",
      "password": "password",
      "database": "evms",
      "maxConnectionPoolSize": 50,
      "connectionAcquisitionTimeout": 60000,
      "connectionTimeout": 30000,
      "maxTransactionRetryTime": 30000,
      "encrypted": false,
      "trust": "TRUST_ALL_CERTIFICATES"
    },
    "retry": {
      "maxRetries": 3,
      "retryDelay": 1000,
      "backoffMultiplier": 2
    },
    "healthCheck": {
      "enabled": true,
      "interval": 30000,
      "timeout": 5000
    }
  },
  
  "messaging": {
    "nats": {
      "servers": ["nats://localhost:4222"],
      "name": "evms-client",
      "maxReconnectAttempts": -1,
      "reconnectTimeWait": 2000,
      "timeout": 20000,
      "pingInterval": 120000,
      "maxPingOut": 2,
      "verbose": false,
      "pedantic": false
    },
    "jetstream": {
      "timeout": 5000
    },
    "streams": {
      "evms": {
        "name": "EVMS",
        "subjects": [
          "evms.scans.*",
          "evms.vulnerabilities.*",
          "evms.risks.*",
          "evms.alerts.*",
          "evms.tasks.*",
          "evms.agents.*",
          "evms.graphrl.*",
          "evms.hotl.*"
        ],
        "retention": "limits",
        "maxConsumers": -1,
        "maxMsgs": 1000000,
        "maxBytes": -1,
        "maxAge": 604800000000000,
        "maxMsgSize": -1,
        "storage": "file",
        "replicas": 1,
        "duplicateWindow": 120000000000
      }
    },
    "kv": {
      "bucket": "evms-cache",
      "description": "EVMS Key-Value Store",
      "maxValueSize": 1048576,
      "history": 10,
      "ttl": 86400000000000,
      "maxBytes": 104857600,
      "storage": "file",
      "replicas": 1
    }
  },
  
  "security": {
    "jwtExpiresIn": "24h",
    "jwtIssuer": "evms",
    "jwtAudience": "evms-users",
    "password": {
      "minLength": 12,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireNumbers": true,
      "requireSymbols": true,
      "maxAge": 90
    },
    "sessionMaxAge": 86400000,
    "sessionSecure": false,
    "sessionHttpOnly": true,
    "sessionSameSite": "strict",
    "rateLimit": {
      "windowMs": 900000,
      "max": 100,
      "skipSuccessfulRequests": false
    },
    "cors": {
      "origin": false,
      "credentials": true,
      "methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
      "allowedHeaders": [
        "Origin",
        "X-Requested-With",
        "Content-Type",
        "Accept",
        "Authorization"
      ]
    },
    "encryption": {
      "algorithm": "aes-256-gcm"
    },
    "api": {
      "keyHeader": "X-API-Key",
      "keyLength": 32
    },
    "tls": {
      "enabled": false
    },
    "headers": {
      "csp": {
        "directives": {
          "defaultSrc": ["'self'"],
          "styleSrc": ["'self'", "'unsafe-inline'"],
          "scriptSrc": ["'self'"],
          "imgSrc": ["'self'", "data:", "https:"],
          "connectSrc": ["'self'"],
          "fontSrc": ["'self'"],
          "objectSrc": ["'none'"],
          "mediaSrc": ["'self'"],
          "frameSrc": ["'none'"]
        }
      },
      "hsts": {
        "maxAge": 31536000,
        "includeSubDomains": true,
        "preload": true
      },
      "noSniff": true,
      "frameguard": {
        "action": "deny"
      },
      "xssFilter": true
    }
  },
  
  "logging": {
    "level": "info",
    "format": "json",
    "timestamp": true,
    "colorize": false,
    "console": {
      "enabled": true,
      "level": "info",
      "format": "simple"
    },
    "file": {
      "enabled": true,
      "level": "info",
      "filename": "evms.log",
      "dirname": "./data/logs",
      "maxsize": 10485760,
      "maxFiles": 5,
      "datePattern": "YYYY-MM-DD",
      "zippedArchive": true
    },
    "errorFile": {
      "enabled": true,
      "filename": "error.log",
      "dirname": "./data/logs",
      "maxsize": 10485760,
      "maxFiles": 10,
      "datePattern": "YYYY-MM-DD",
      "zippedArchive": true
    },
    "audit": {
      "enabled": true,
      "level": "info",
      "filename": "audit.log",
      "dirname": "./data/logs",
      "maxsize": 52428800,
      "maxFiles": 20,
      "datePattern": "YYYY-MM-DD",
      "zippedArchive": true
    },
    "security": {
      "enabled": true,
      "level": "warn",
      "filename": "security.log",
      "dirname": "./data/logs",
      "maxsize": 52428800,
      "maxFiles": 30,
      "datePattern": "YYYY-MM-DD",
      "zippedArchive": true
    },
    "performance": {
      "enabled": false,
      "level": "info",
      "filename": "performance.log",
      "dirname": "./data/logs",
      "maxsize": 26214400,
      "maxFiles": 10,
      "datePattern": "YYYY-MM-DD",
      "zippedArchive": true
    },
    "defaultMeta": {
      "service": "evms",
      "version": "1.0.0"
    },
    "filters": {
      "excludeFields": [
        "password",
        "token",
        "secret",
        "key",
        "authorization",
        "cookie"
      ],
      "sampling": {
        "enabled": false,
        "rate": 0.1,
        "levels": ["debug", "trace"]
      }
    },
    "correlation": {
      "enabled": true,
      "traceIdHeader": "x-trace-id",
      "requestIdHeader": "x-request-id"
    }
  },
  
  "graphrl": {
    "modelPath": "./data/models",
    "trainingEnabled": true,
    "batchSize": 32,
    "learningRate": 0.001,
    "epsilon": 0.1,
    "gamma": 0.99,
    "targetUpdateFreq": 1000,
    "memorySize": 100000,
    "minMemorySize": 1000,
    "trainingFreq": 4
  },
  
  "agents": {
    "maxConcurrent": 10,
    "heartbeatInterval": 30000,
    "timeoutMs": 300000,
    "retryAttempts": 3,
    "retryDelay": 5000
  },
  
  "scanning": {
    "defaultTimeout": 300,
    "maxTargets": 1000,
    "rateLimitRps": 10,
    "engines": {
      "nmap": {
        "enabled": true,
        "path": "/usr/bin/nmap",
        "maxConcurrent": 5
      },
      "masscan": {
        "enabled": true,
        "path": "/usr/bin/masscan",
        "maxConcurrent": 3
      },
      "nuclei": {
        "enabled": true,
        "path": "/usr/bin/nuclei",
        "maxConcurrent": 10
      }
    }
  },
  
  "hotl": {
    "reviewTimeout": 86400000,
    "escalationTimeout": 3600000,
    "notifications": {
      "email": {
        "enabled": false
      },
      "slack": {
        "enabled": false
      },
      "webhook": {
        "enabled": false
      }
    }
  },
  
  "dashboard": {
    "port": 3001,
    "refreshInterval": 30000,
    "maxConnections": 1000,
    "websocket": {
      "enabled": true,
      "pingInterval": 30000,
      "pingTimeout": 5000
    }
  }
}